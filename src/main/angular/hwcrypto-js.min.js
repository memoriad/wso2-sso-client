/*! This is hwcrypto.js 0.0.13 generated on 2019-10-08 */
/* DO NOT EDIT (use src/hwcrypto.js) */

var hwcrypto=function(){"use strict";function a(a){return navigator.mimeTypes&&a in navigator.mimeTypes}function b(a){return"function"==typeof window[a]}function c(a){if("string"==typeof a){for(var b=Math.floor(a.length/2),c=new Uint8Array(b),d=0;d<b;d++)c[d]=parseInt(a.substr(2*d,2),16);return c}}function d(a){for(var b="",c=0;c<a.length;c++)b+=(a[c]<16?"0":"")+a[c].toString(16);return b.toLowerCase()}function e(a){return"hwc"+a.replace("/","").replace("-","")}function f(a){var b=e(a);if(document.getElementById(b))return m("Plugin element already loaded"),document.getElementById(b);m("Loading plugin for "+a+" into "+b);var c='<object id="'+b+'" type="'+a+'" style="width: 1px; height: 1px; position: absolute; visibility: hidden;"></object>',d=document.createElement("div");return d.setAttribute("id","pluginLocation"+b),document.body.appendChild(d),document.getElementById("pluginLocation"+b).innerHTML=c,document.getElementById(b)}function g(){var c="probe() detected ";b(o)&&m(c+o),a(n)&&m(c+n)}function h(){function a(a){switch(m("Error: "+a+" with: "+c.errorMessage),parseInt(a)){case 1:return p;case 2:return q;case 15:return s;case 17:return r;case 19:return v;default:return m("Unknown error: "+a+" with: "+c.errorMessage),t}}function b(b){return new Error(a(b))}this._name="NPAPI/BHO for application/x-digidoc";var c=f(n),d={};this.check=function(){return new Promise(function(a,b){setTimeout(function(){a(void 0!==c.version)},0)})},this.getVersion=function(){return new Promise(function(a,b){a(c.version)})},this.getCertificate=function(a){return a&&a.lang&&(c.pluginLanguage=a.lang),new Promise(function(e,f){try{var g=c.version.split("."),h=g[0]>=3&&g[1]>=13?c.getCertificate(a.filter):c.getCertificate();0!==parseInt(c.errorCode)?f(b(c.errorCode)):(d[h.cert]=h.id,e({hex:h.cert}))}catch(a){m(a),f(b(c.errorCode))}})},this.sign=function(a,e,f){return new Promise(function(g,h){var i=d[a.hex];if(i)try{var j=f.lang||"en",k=f.info||"",l=c.version.split(".");g({hex:l[0]>=3&&l[1]>=13?c.sign(i,e.hex,j,k):c.sign(i,e.hex,j)})}catch(a){m(JSON.stringify(a)),h(b(c.errorCode))}else m("invalid certificate: "+a),h(new Error(r))})}}function i(){this._name="Chrome native messaging extension";var a=null;this.check=function(){return new Promise(function(c,d){if(!b(o))return c(!1);a=new window[o],c(a?!0:!1)})},this.getVersion=function(){return a.getVersion()},this.getCertificate=function(b){return a.getCertificate(b)},this.sign=function(b,c,d){return a.sign(b,c,d)}}function j(){this._name="No implementation",this.check=function(){return new Promise(function(a,b){a(!0)})},this.getVersion=function(){return Promise.reject(new Error(u))},this.getCertificate=function(){return Promise.reject(new Error(u))},this.sign=function(){return Promise.reject(new Error(u))}}function k(a){return new Promise(function(b,c){var d=new a;d.check().then(function(a){a?(m("Using backend: "+d._name),w=d,b(!0)):(m(d._name+" check() failed"),b(!1))})})}function l(c){return new Promise(function(d,e){function f(){k(h).then(function(a){d(a?!0:k(j))})}return m("Autodetecting best backend"),void 0===c&&(c=!1),null===w||c?-1!=navigator.userAgent.indexOf("MSIE")||-1!=navigator.userAgent.indexOf("Trident")?(m("Assuming IE BHO, testing"),f()):b(o)?void k(i).then(function(a){a?d(!0):f()}):a(n)?f():void d(k(j)):d(!0)})}var m=function(a){};m("hwcrypto.js activated"),window.addEventListener=window.addEventListener||window.attachEvent;var n="application/x-digidoc",o="TokenSigning",p="user_cancel",q="no_certificates",r="invalid_argument",s="driver_error",t="technical_error",u="no_implementation",v="not_allowed";window.addEventListener("load",function(a){g()});var w=null,x={};return x.use=function(a){return new Promise(function(b,c){void 0===a||"auto"===a?l().then(function(a){b(a)}):b("chrome"===a?k(i):"npapi"===a?k(h):!1)})},x.debug=function(){return new Promise(function(a,b){l().then(function(b){w.getVersion().then(function(b){a("hwcrypto.js 0.0.13 with "+w._name+" "+b)},function(b){a("hwcrypto.js 0.0.13 with failing backend "+w._name)})})})},x.getCertificate=function(a){return"object"!=typeof a?(m("getCertificate options parameter must be an object"),Promise.reject(new Error(r))):(a&&!a.lang&&(a.lang="en"),l().then(function(b){return"https:"!==location.protocol&&"file:"!==location.protocol?Promise.reject(new Error(v)):w.getCertificate(a).then(function(a){return a.hex&&!a.encoded&&(a.encoded=c(a.hex)),a})}))},x.sign=function(a,b,e){return arguments.length<2?Promise.reject(new Error(r)):(e&&!e.lang&&(e.lang="en"),b.type&&(b.value||b.hex)?(b.hex&&!b.value&&(m("DEPRECATED: hash.hex as argument to sign() is deprecated, use hash.value instead"),b.value=c(b.hex)),b.value&&!b.hex&&(b.hex=d(b.value)),l().then(function(d){return"https:"!==location.protocol&&"file:"!==location.protocol?Promise.reject(new Error(v)):w.sign(a,b,e).then(function(a){return a.hex&&!a.value&&(a.value=c(a.hex)),a})})):Promise.reject(new Error(r)))},x.NO_IMPLEMENTATION=u,x.USER_CANCEL=p,x.NOT_ALLOWED=v,x.NO_CERTIFICATES=q,x.TECHNICAL_ERROR=t,x.INVALID_ARGUMENT=r,x}();